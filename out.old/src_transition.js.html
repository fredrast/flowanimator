<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: src/transition.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: src/transition.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file src/transition.js
 * @description Defines the {@link Transition} class for representing the
 * status transition of an issue and the {@link TransitionCollection} class for
 * holding all the status transitions of the currently loaded project.
 */

/**
 * @constructor Transition
 * @description Constructor for objects to represent the status transitions
 * in the current project
 */
export function Transition(
  story,
  fromColumn,
  toColumn,
  timestamp,
  transitionStartDateTime
) {
  /* console.log('Creating new Transition'); */
  /* console.log(story); */
  /* console.log(fromColumn); */
  /* console.log(toColumn); */
  /* console.log(timestamp); */
  this.story = story;
  this.fromColumn = fromColumn;
  this.toColumn = toColumn;
  this.timestamp = timestamp;
  this.date = new Date(timestamp).toISOString();
  this.transitionStartDateTime = transitionStartDateTime;

  // /* console.log(new Date(this.timestamp).toISOString()); */

  this.getTimeStamp = function() {
    return this.timeStamp.getTime();
  };

  this.getTransitionStartDateTime = () => {
    return this.transitionStartDateTime;
  };

  this.getTransitionStartOnTimeline = () => {
    if (
      // these are not set in the constructor but only later on from within animation.js, so better check for their presence to be sure
      Transition.calendarTimeToAnimationTime &amp;&amp;
      this.getFirstTransitionDate
    ) {
      return Transition.calendarTimeToAnimationTime(
        this.getTransitionStartDateTime() - this.getFirstTransitionDate()
      );
    }
  };
}

/**
 * @constructor TransitionCollection
 * @description Constructor for the for the TransitionCollection object
 * holding all the status transitions of the currently loaded project.
 */
export function TransitionCollection() {
  this.transitions = [];

  this.push = transition => {
    this.transitions.push(transition);
  };

  this.addTransitions = transitionsToAdd => {
    this.transitions = this.transitions.concat(transitionsToAdd);
  };

  this.clear = function() {
    this.transitions.length = 0;
    this.transitions = []; // TODO what is the most appropriate way to clear an array?
    /* console.log('**************** transitionCollection cleared!'); */
  };

  Transition.prototype.getSortOrder = (firstTransition, secondTransition) => {
    if (
      firstTransition.transitionStartDateTime &lt;
      secondTransition.transitionStartDateTime
    ) {
      return -1;
    } else if (
      firstTransition.transitionStartDateTime >
      secondTransition.transitionStartDateTime
    ) {
      return 1;
    } else {
      // Same timestamp, need some other way to determine the sort order
      if (firstTransition.story === secondTransition.story) {
        // Same timestamp, case 1:
        // Same issue transitioning over several columns at the same time,
        // sorting according to the sequence of the columns transitioned into
        if (
          firstTransition.toColumn.number &lt; secondTransition.toColumn.number
        ) {
          return -1;
        } else {
          return 1;
        }
      } else {
        // Same timestamp, case 2:
        // Different issues transitioning at the same time,
        // sort order is arbitrary but result should be conistent,
        // sorting according to the alphabetic order of the issue id:s
      }

      return firstTransition.story.id.localeCompare(secondTransition.story.id);
    }
  };

  this.sort = function() {
    this.transitions.sort(Transition.prototype.getSortOrder);
  };

  this.getFirstTransitionDate = () => {
    return this.transitions[0].transitionStartDateTime;
  };

  Transition.prototype.getFirstTransitionDate = this.getFirstTransitionDate; // Making it possible to get the first transition date also on Transition level, which makes it possible for the transition to calculate its own animation start time

  this.getLastTransitionDate = () => {
    return this.transitions[this.transitions.length - 1]
      .transitionStartDateTime;
  };

  this.getTimespan = function() {
    return this.getLastTransitionDate() - this.getFirstTransitionDate();
  };

  this.getIterator = function*() {
    for (var transition of this.transitions) {
      yield transition;
    }
  };
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-src_jira.html">src/jira</a></li></ul><h3>Classes</h3><ul><li><a href="Animation.html">Animation</a></li><li><a href="Button.html">Button</a></li><li><a href="Column.html">Column</a></li><li><a href="ColumnCollection.html">ColumnCollection</a></li><li><a href="FlowAnimatorTimeline.html">FlowAnimatorTimeline</a></li><li><a href="Story.html">Story</a></li><li><a href="StoryCollection.html">StoryCollection</a></li><li><a href="Transition.html">Transition</a></li><li><a href="TransitionCollection.html">TransitionCollection</a></li><li><a href="Ui.html">Ui</a></li></ul><h3>Global</h3><ul><li><a href="global.html#css">css</a></li><li><a href="global.html#drawLines">drawLines</a></li><li><a href="global.html#getColor">getColor</a></li><li><a href="global.html#normalizeShadow">normalizeShadow</a></li><li><a href="global.html#transform">transform</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Sun Nov 03 2019 21:19:38 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
